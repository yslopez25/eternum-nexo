<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Eternum: Guerras del Nexo ‚Äî Prototype</title>

  <!-- CSS EMBEBIDO -->
  <style>
  :root{
    --bg:#0a0f1f; --panel:#0f1736; --panel-2:#121e4f; --accent:#5e7bff;
    --accent-2:#00d4ff; --text:#e9efff; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,Segoe UI,Arial,sans-serif;
    background: radial-gradient(1200px 700px at 30% -10%, #1b2560 0%, var(--bg) 60%),
                radial-gradient(900px 600px at 120% 20%, #10234d 0%, var(--bg) 55%),
                var(--bg); color:var(--text);
  }
  #app{max-width:1100px;margin:0 auto;padding:12px 12px 90px}

  /* Paneles */
  .status{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
  .panel{background:linear-gradient(180deg,var(--panel),#0b1230);border:1px solid #1d2554;border-radius:16px;padding:10px;box-shadow:var(--shadow);}
  #players .tag{display:block;margin:6px 0;padding:8px 10px;border-radius:12px;background:rgba(30,37,84,.55);border:1px solid #273079}
  #players .small{opacity:.85;font-size:.9em}
  #log{max-height:180px;overflow:auto}
  #log .line{padding:4px 6px;border-radius:8px;margin:2px 0;background:rgba(255,255,255,.02)}
  #log .win{background:rgba(88,242,155,.08)}
  #log .warn{background:rgba(255,209,102,.08)}
  #log .bad{background:rgba(255,107,107,.08)}

  /* Tablero y minimapa */
  .board-wrap{position:relative}
  #board{
    display:block;width:100%;min-height:360px;border-radius:16px;border:1px solid #1d2554;
    background: radial-gradient(800px 500px at 50% 20%, #14255a 0%, #0b1436 55%, #08102a 100%);
    box-shadow:var(--shadow)
  }
  .minimap-wrap{
    position:absolute; top:12px; right:12px; width:112px; height:112px; z-index:5;
    border:1px solid #2a3a8a; border-radius:12px; background:#0b1436cc; backdrop-filter:blur(4px); box-shadow:var(--shadow);
    display:flex; align-items:center; justify-content:center; gap:6px; padding:6px;
  }
  #minimap{display:block; width:96px; height:96px; border-radius:8px}
  .mm-controls{
    position:absolute; top:6px; right:6px; display:flex; gap:6px;
  }
  .mm-btn{
    width:28px;height:28px;border-radius:999px;border:1px solid #2a3a8a;
    background:linear-gradient(180deg, #1b2b6d, #10183a); color:#e9efff; font-weight:800;
    display:flex;align-items:center;justify-content:center;cursor:pointer; box-shadow:var(--shadow)
  }
  .minimap-wrap.minimized{width:auto;height:auto;padding:0}
  .minimap-wrap.minimized #minimap{display:none}

  /* Dock inferior */
  .dock{
    position:fixed; left:0; right:0; bottom:0; padding:10px 14px calc(env(safe-area-inset-bottom,0px) + 10px);
    background:linear-gradient(180deg, #0d1430dd, #0a0f1fef); border-top:1px solid #1d2554; display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap;
  }
  .btn{
    width:64px; height:64px; border-radius:999px; border:1px solid #2a3a8a;
    background:linear-gradient(180deg, var(--accent), #3e54f5); color:#fff; font-weight:800;
    display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow:var(--shadow);
    user-select:none; -webkit-tap-highlight-color:transparent;
  }
  .btn.secondary{background:linear-gradient(180deg, #1b2b6d, #10183a)}
  .btn:active{transform:translateY(1px)}
  .pill{
    display:inline-flex; align-items:center; gap:6px; padding:8px 10px; border-radius:999px; border:1px solid #2a3a8a;
    background:linear-gradient(180deg, var(--panel-2), #0b1230); color:#e9efff; font-weight:700;
  }
  .pill small{opacity:.85}
  .vol{appearance:none; width:110px; height:8px; border-radius:8px; background:#1d2a66; outline:none}
  .vol::-webkit-slider-thumb{appearance:none; width:18px; height:18px; border-radius:50%; background:#5e7bff; border:2px solid #9fb0ff}

  @media (max-width:700px){
    #log{max-height:140px}
    .minimap-wrap{top:8px; right:8px}
  }
  </style>
</head>
<body>
  <div id="app">
    <div class="status">
      <div id="players" class="panel"></div>
      <div id="log" class="panel"></div>
    </div>

    <div class="board-wrap">
      <canvas id="board" width="960" height="640"></canvas>
      <div class="minimap-wrap" id="mmWrap">
        <div class="mm-controls">
          <button class="mm-btn" id="mmToggle" title="Mostrar/Ocultar">‚àí</button>
        </div>
        <canvas id="minimap" width="96" height="96" title="Toca para seleccionar"></canvas>
      </div>
    </div>
  </div>

  <!-- Barra inferior -->
  <div class="dock">
    <div class="btn" id="newGame" title="Nueva partida">‚Üª</div>
    <div class="btn" id="nextPhase" title="Siguiente fase">‚ñ∂</div>
    <div class="btn" id="playTurn" title="Turno completo">‚è≠</div>
    <div class="btn secondary" id="resetGame" title="Reiniciar">‚å´</div>

    <span class="pill"><span id="phase">Fase</span><small id="turn">| Turno</small></span>

    <div class="pill" style="gap:10px">
      <button class="btn secondary" id="mute" style="width:48px;height:48px" title="Silencio">üîä</button>
      <input class="vol" type="range" id="vol" min="0" max="1" step="0.01" />
    </div>
  </div>

  <!-- Mostrar errores JS si hubiera -->
  <script>
    window.addEventListener('error', e => {
      const pre = document.createElement('pre');
      pre.textContent = 'Error JS: ' + e.message;
      pre.style = 'background:#330; color:#ffcc66; padding:8px; border:1px solid #663; border-radius:8px; white-space:pre-wrap; position:fixed; left:10px; bottom:90px; z-index:9999';
      document.body.appendChild(pre);
    });
  </script>

  <script src="app.js"></script>
</body>
</html>
